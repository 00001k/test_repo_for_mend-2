trigger: none

jobs:
- job: scanpythonapp
  workspace:
    clean: all
  pool:
    image: 'veracode/pipeline-scan'
  steps:
  - task: Docker@2
    displayName: Login to ACR
    inputs:
      containerRegistry: 'jddintegrationtest.azurecr.io/veracode/pipeline-scan:latest'
      command: login
      
  - script: |
      - zip myapp.zip ./src/
      - java -jar /opt/veracode/pipeline-scan.jar
        -vid $VERACODE_API_ID -vkey $VERACODE_API_KEY
        --file myapp.zip